openapi: "3.0.0"
info:
  title: Nuts registry API spec
  description: API specification for RPC services available at the nuts-registry
  version: 1.0.0
  license:
    name: GPLv3
paths:
  /internal/registry/v1/did:
    post:
      summary: "Creates a new Nuts DID"
      operationId: "createDID"
      tags:
        - DID
      responses:
        "201":
          description: "New DID has been created successfully. Returns the DID Document."
          content:
            application/json+did-document:
              schema:
                $ref: '#/components/schemas/DIDDocument'
        "500":
          description: "An error occurred while processing the request"
          content:
            text/plain:
              schema:
                type: string
  /internal/registry/v1/did/{didOrTag}:
    parameters:
      - name: didOrTag
        in: path
        description: "URL encoded DID or tag. When given a tag it must resolve to exactly one DID."
        required: true
        example:
          - "did:nuts:1234"
          - "tag:client-987731"
        schema:
          type: string
    get:
      summary: "Retrieves a Nuts DID Document"
      operationId: "getDID"
      tags:
        - DID
      responses:
        "200":
          description: "DID has been found and returned."
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DIDResolutionResult"
        "404":
          description: "DID couldn't be found."
          content:
            text/plain:
              schema:
                type: string
        "500":
          description: "An error occurred while processing the request."
          content:
            text/plain:
              schema:
                type: string
    put:
      summary: "Updates a Nuts DID"
      operationId: "updateDID"
      tags:
        - DID
      responses:
        "200":
          description: "DID Document has been updated."
          content:
            application/json+did-document:
              schema:
                type: object
        "400":
          description: "DID couldn't be updated because the input conflicts."
          content:
            text/plain:
              schema:
                type: string
        "404":
          description: "DID couldn't be found."
          content:
            text/plain:
              schema:
                type: string
        "500":
          description: "An error occurred while processing the request"
          content:
            text/plain:
              schema:
                type: string

components:
  schemas:
    DIDDocument:
      type: object
      description: The actual DID Document in JSON representation.
    DIDDocumentMetadata:

    DIDResolutionResult:
      properties:
        document:
          $ref: "#/components/schemas/DIDDocument"
        documentMetadata:
          type: object
          description: Metadata describing the resolved DID Document (a.k.a. DID Document Metadata).
        resolutionMetadata:
          type: object
          description: Metadata collected during DID Document (a.k.a. DID Resolution Metadata).
    DIDUpdateRequest:
      properties:
        document:
          $ref: "#/components/schemas/DIDDocument"
        currentVersion:
          description: "SHA-256 hash of the last version of the DID Document"